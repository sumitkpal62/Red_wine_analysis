regplot_feature<-ggplot(my_data, aes(x=fixed.acidity, y=volatile.acidity)) +
geom_point(color='darkblue', alpha=0.6) +
geom_smooth(method = 'lm', se = FALSE, color='red', linewidth=1.2) +
labs(
title="Scatter plot with linear regression line",
x='Fixed Acidity',
y='Volatile Acidity'
) +
theme_minimal() +
theme(
axis.text.x = element_text(colour = 'darkblue', size = 12),
axis.text.y = element_text(colour = 'darkblue', size = 12),
axis.ticks = element_line(colour = 'red'),
axis.line.x = element_line(color='red', linewidth = 1),
axis.line.y = element_line(color='red', linewidth = 1),
title = element_text(face = 'bold', hjust = [0,1])
regplot_feature<-ggplot(my_data, aes(x=fixed.acidity, y=volatile.acidity)) +
geom_point(color='darkblue', alpha=0.6) +
geom_smooth(method = 'lm', se = FALSE, color='red', linewidth=1.2) +
labs(
title="Scatter plot with linear regression line",
x='Fixed Acidity',
y='Volatile Acidity'
) +
theme_minimal() +
theme(
axis.text.x = element_text(colour = 'darkblue', size = 12),
axis.text.y = element_text(colour = 'darkblue', size = 12),
axis.ticks = element_line(colour = 'red'),
axis.line.x = element_line(color='red', linewidth = 1),
axis.line.y = element_line(color='red', linewidth = 1),
title = element_text(face = 'bold', hjust = '1')
)
regplot_feature<-ggplot(my_data, aes(x=fixed.acidity, y=volatile.acidity)) +
geom_point(color='darkblue', alpha=0.6) +
geom_smooth(method = 'lm', se = FALSE, color='red', linewidth=1.2) +
labs(
title="Scatter plot with linear regression line",
x='Fixed Acidity',
y='Volatile Acidity'
) +
theme_minimal() +
theme(
axis.text.x = element_text(colour = 'darkblue', size = 12),
axis.text.y = element_text(colour = 'darkblue', size = 12),
axis.ticks = element_line(colour = 'red'),
axis.line.x = element_line(color='red', linewidth = 1),
axis.line.y = element_line(color='red', linewidth = 1),
title = element_text(face = 'bold', hjust = 0.5)
)
regplot_feature
regplot_feature<-ggplot(my_data, aes(x=fixed.acidity, y=volatile.acidity)) +
geom_point(color='darkblue', alpha=0.6) +
geom_smooth(method = 'lm', se = FALSE, color='red', linewidth=1.2) +
labs(
title="Scatter plot with linear regression line",
x='Fixed Acidity',
y='Volatile Acidity'
) +
theme_minimal() +
theme(
axis.text.x = element_text(colour = 'darkblue', size = 12),
axis.text.y = element_text(colour = 'darkblue', size = 12),
axis.ticks = element_line(colour = 'red'),
axis.line.x = element_line(color='red', linewidth = 1),
axis.line.y = element_line(color='red', linewidth = 1),
title = element_text(face = 'bold', hjust = 1)
)
regplot_feature
regplot_feature<-ggplot(my_data, aes(x=fixed.acidity, y=volatile.acidity)) +
geom_point(color='darkblue', alpha=0.6) +
geom_smooth(method = 'lm', se = FALSE, color='red', linewidth=1.2) +
labs(
title="Scatter plot with linear regression line",
x='Fixed Acidity',
y='Volatile Acidity'
) +
theme_minimal() +
theme(
axis.text.x = element_text(colour = 'darkblue', size = 12),
axis.text.y = element_text(colour = 'darkblue', size = 12),
axis.ticks = element_line(colour = 'red'),
axis.line.x = element_line(color='red', linewidth = 1),
axis.line.y = element_line(color='red', linewidth = 1),
title = element_text(face = 'bold', hjust = 0.5)
)
regplot_feature
regplot_feature<-ggplot(my_data, aes(x=fixed.acidity, y=volatile.acidity)) +
geom_point(color='darkblue', alpha=0.6) +
geom_smooth(method = 'lm', se = FALSE, color='red', linewidth=1.2) +
labs(
title="Scatter plot with linear regression line",
x='Fixed Acidity',
y='Volatile Acidity',
) +
theme_minimal() +
theme(
axis.text.x = element_text(colour = 'darkblue', size = 12),
axis.text.y = element_text(colour = 'darkblue', size = 12),
axis.ticks = element_line(colour = 'red'),
axis.line.x = element_line(color='red', linewidth = 1),
axis.line.y = element_line(color='red', linewidth = 1),
title = element_text(face = 'bold', hjust = 0.5),
plot.title = element_text(face='bold', hjust = 0.5)
)
regplot_feature
line_plot<-ggplot(my_data, aes(x=fixed.acidity)) +
geom_line(color='darkblue', alpha=0.5) +
theme_minimal()
line_plot
line_plot<-ggplot(my_data, aes(x=fixed.acidity)) +
geom_line(~ fixed.acidity, color='darkblue', alpha=0.5) +
theme_minimal()
line_plot<-ggplot(my_data, aes(x=fixed.acidity)) +
geom_line(~ aes(x=fixed.acidity), color='darkblue', alpha=0.5) +
theme_minimal()
line_plot
line_plot<-ggplot(my_data, aes(x=fixed.acidity)) +
geom_line(aes(x=fixed.acidity, y=alcohol), color='darkblue', alpha=0.5) +
theme_minimal()
line_plot
load("E:/Data Anaysis/Red_wine_analysis/Red_wine_analysis.Rproj")
load("E:/Data Anaysis/Red_wine_analysis/.Rhistory")
load("E:/Data Anaysis/Red_wine_analysis/.RData")
regplot_feature
source("E:/Data Anaysis/Red_wine_analysis/main.R")
summary_stats_rbind<-base::rbind(
mean_dplyr,
median_dplyr,
mode_values,
)
summary_stats_rbind <- rbind(
mean_dplyr,
median_dplyr,
mode_values
)
summary_stats_rbind <- rbind(
mean_dplyr,
median_dplyr,
mode_values
)
summary_stats_rbind<-rbind(
mean_dplyr,
median_dplyr,
mode_values
)
print(summary_stats_rbind)
write.csv(summary_stats_df, file = './r_output/mean_median_mode_output.csv', row.names = FALSE)
min_values<- my_data %>% summarise(across(is.numeric, ~ min(., na.rm = TRUE)))
max_values<- my_data %>% summarise(across(is.numeric, ~ max(., na.rm=TRUE)))
print(min_values, max_values)
range_values=max_values-min_values
print(range_values)
min_max_df<-bind_rows(
'Min'=round(min_values),
'Max'=round(max_values),
'Range'=round(range_values),
.id = "Attributes"
)
print(min_values)
print(max_values)
range_values=max_values-min_values
print(range_values)
min_max_df<-bind_rows(
'Min'=round(min_values),
'Max'=round(max_values),
'Range'=round(range_values),
.id = "Attributes"
)
print(min_max_df)
var_value<- my_data %>% summarise(across(is.numeric, ~ var(., na.rm=TRUE)))
std_value<- my_data %>% summarise(across(is.numeric, ~ sd(., na.rm=TRUE)))
print(var_value)
print(std_value)
Q1_value<- my_data %>% reframe(across(is.numeric, ~ quantile(., 0.25, na.rm=TRUE)))
Q3_value<- my_data %>% reframe(across(is.numeric, ~ quantile(., 0.75, na.rm=TRUE)))
IQR_value<- Q3_value-Q1_value
Q_df<- bind_rows(
"Q1"=Q1_value,
"Q3"=Q3_value,
"IQR"=IQR_value,
.id = "Quartile"
)
print(Q_df)
CV<- (std_value/mean_dplyr)*100
print(round(CV,2))
CV2<- my_data %>% summarise(across(is.numeric, ~ CoefVar(., na.rm=TRUE)))
print(round(CV2*100,2))
library(e1071)
skewness_value<- my_data %>% summarise(across(is.numeric, ~ skewness(., na.rm = TRUE)))
rownames(skewness_value)<-"Skewness"
skewness_df<- rbind(
skewness_value
)
print(skewness_value)
kurtosis_value<- my_data %>% summarise(across(is.numeric, ~ kurtosis(., na.rm = TRUE)))
print(kurtosis_value)
library('ggplot2')
library('patchwork')
library('tidyverse')
df_long<- my_data %>%
pivot_longer(
cols = everything(),
names_to = 'Feature',
values_to = 'Value'
)
print(df_long)
p_all_features <- ggplot(df_long, aes(x=Value)) +
geom_histogram(aes(y=after_stat(density)), bins = 30, fill='lightblue', color='black', alpha=0.7) +
geom_density(color='red', linewidth=1) +
facet_wrap(~ Feature, scales='free', ncol=3) +
labs(
title = "Distribution of All Features",
x = "Value",
y = "Density"
) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) # Center the title
p_all_features
p_all_boxplot<-ggplot(df_long, mapping = aes(x=Feature, y=Value)) +
geom_boxplot(fill='lightblue', color='darkblue', outlier.color = 'red') +
coord_flip() +
facet_wrap(~ Feature, scales='free', ncol=3) +
labs(
title = "Boxplots of All Features",
x = NULL,
y = "Value Distribution"
) +
theme_minimal() +
theme(
axis.text.y = element_blank(),
strip.text = element_text(face = "bold")
)
p_all_boxplot
p_all_violin<-ggplot(df_long, aes(x=Feature, y=Value)) +
geom_violin(fill='lightblue',draw_quantiles = c(0.25,0.75) ,quantile.colour = 'red') +
geom_boxplot(fill='blue', box.color = 'red', width = 0.1)+
facet_wrap(~ Feature, scales='free' ,ncol = 3) +
coord_flip() +
labs(
title = "Violinplot of all features",
x=NULL,
y="Value"
) +
theme_minimal() +
theme(
axis.text.y = element_blank(),
strip.text = element_text(face = 'bold')
)
p_all_violin
regplot_feature<-ggplot(my_data, aes(x=fixed.acidity, y=volatile.acidity)) +
geom_point(color='darkblue', alpha=0.6) +
geom_smooth(method = 'lm', se = FALSE, color='red', linewidth=1.2) +
labs(
title="Scatter plot with linear regression line",
x='Fixed Acidity',
y='Volatile Acidity',
) +
theme_minimal() +
theme(
axis.text.x = element_text(colour = 'darkblue', size = 12),
axis.text.y = element_text(colour = 'darkblue', size = 12),
axis.ticks = element_line(colour = 'red'),
axis.line.x = element_line(color='red', linewidth = 1),
axis.line.y = element_line(color='red', linewidth = 1),
title = element_text(face = 'bold', hjust = 0.5),
plot.title = element_text(face='bold', hjust = 0.5)
)
regplot_feature
cor(my_data)
round(cor(my_data),2)
corr_values_pearson<-cor(my_data, method = 'pearson')
corr_values_pearson
corr_values_spearman<-cor(my_data, method = 'spearman')
corr_values_spearman
covar_values<-cov(my_data)
covar_values
heatmap(my_data)
heatmap(df_long)
heatmap(corr_values_pearson)
ggplot(corr_values_pearson, aes(x=corr_values_pearson, y=corr_values_pearson))+
heatmap(corr_values_pearson)+
theme_minimal()
heatmap(corr_values_pearson, verbose = TRUE)
heatmap_ggplot <- ggplot(df_long, aes(x = Var1, y = Var2, fill = Correlation)) +
# 1. Base Tile Layer
geom_tile(color = "white", linewidth = 0.5) +
# 2. Optional: Add correlation values as text (Crucial Customization)
geom_text(aes(label = round(Correlation, 2)), color = "black", size = 3) +
# 3. Custom Color Scale (Crucial Customization)
# Use a diverging scale (e.g., blue for positive, red for negative)
scale_fill_gradient2(
low = "red",         # Negative correlations
mid = "white",       # Zero correlation
high = "darkgreen",  # Positive correlations
midpoint = 0,        # Center the color scale at 0
limit = c(-1, 1),    # Ensure scale ranges from -1 to 1
name = "Pearson\nCorrelation"
) +
# 4. Custom Theme and Labels
labs(title = "Custom Correlation Heatmap (ggplot2)", x = NULL, y = NULL) +
theme_minimal() +
theme(
# Rotate X-axis labels to prevent overlap
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 10),
# Hide the background grid lines
panel.grid.major = element_blank(),
# Remove plot border
panel.border = element_blank()
)
print(heatmap_ggplot)
# 1. Convert matrix to a data frame, keeping row names as a column
cor_df <- corr_values_pearson %>%
as.data.frame() %>%
rownames_to_column("Var1")
# 2. Pivot the data frame to the long format
cor_long <- cor_df %>%
pivot_longer(
cols = -Var1,  # Select all columns EXCEPT 'Var1'
names_to = "Var2",
values_to = "Correlation"
)
heatmap_ggplot <- ggplot(cor_long, aes(x = Var1, y = Var2, fill = Correlation)) +
# 1. Base Tile Layer
geom_tile(color = "white", linewidth = 0.5) +
# 2. Optional: Add correlation values as text (Crucial Customization)
geom_text(aes(label = round(Correlation, 2)), color = "black", size = 3) +
# 3. Custom Color Scale (Crucial Customization)
# Use a diverging scale (e.g., blue for positive, red for negative)
scale_fill_gradient2(
low = "red",         # Negative correlations
mid = "white",       # Zero correlation
high = "darkgreen",  # Positive correlations
midpoint = 0,        # Center the color scale at 0
limit = c(-1, 1),    # Ensure scale ranges from -1 to 1
name = "Pearson\nCorrelation"
) +
# 4. Custom Theme and Labels
labs(title = "Custom Correlation Heatmap (ggplot2)", x = NULL, y = NULL) +
theme_minimal() +
theme(
# Rotate X-axis labels to prevent overlap
axis.text.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 10),
# Hide the background grid lines
panel.grid.major = element_blank(),
# Remove plot border
panel.border = element_blank()
)
print(heatmap_ggplot)
View(cor_df)
rownames_to_column(var1)
rownames_to_column("Var1")
cor_df<-corr_values_pearson %>%
as.data.frame %>%
rownames_to_column("Var1")
cor_long<-cor_df %>%
pivot_longer(
cols = -var1,
names_to = "Var2",
values_to = "Correlation"
)
cor_df<-corr_values_pearson %>%
as.data.frame %>%
rownames_to_column("Var1")
cor_long<-cor_df %>%
pivot_longer(
cols = -Var1,
names_to = "Var2",
values_to = "Correlation"
)
View(cor_long)
cor_df %>%
pivot_longer(
names_to = "Var2",
values_to = "Correlation"
)
cor_df %>%
pivot_longer(
names_to = "Var2",
values_to = "Correlation"
)
cor_df %>%
pivot_longer(
cols = Var1,
names_to = "Var2",
values_to = "Correlation"
)
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation))
heatmap_ggplot
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation)) +
geom_tile(color='white', linewidth = 0.5)
heatmap_ggplot
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation)) +
geom_tile(color='white', linewidth = 0.5) +
scale_fill_gradient2(
low = 'red',
mid = 'white',
high = 'darkgreen',
midpoint = 0,
limit=c(-1,1),
name = 'Pearson\nCorrelation'
)
heatmap_ggplot
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation)) +
geom_tile(color='white', linewidth = 0.5) +
scale_fill_gradient2(
low = 'red',
mid = 'white',
high = 'darkgreen',
midpoint = 0,
limit=c(-1,1),
name = 'Pearson\nCorrelation'
) +
labs(
title = "Correlation Heatmap (ggplot2)",
x=NULL,
y=NULL
) +
theme_minimal()
heatmap_ggplot
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation)) +
geom_tile(color='white', linewidth = 0.5) +
scale_fill_gradient2(
low = 'red',
mid = 'white',
high = 'darkgreen',
midpoint = 0,
limit=c(-1,1),
name = 'Pearson\nCorrelation'
) +
labs(
title = "Correlation Heatmap (ggplot2)",
x=NULL,
y=NULL
) +
theme_minimal() +
theme(
axis.title.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 10),
panel.grid.major = element_blank(),
panel.border=element_blank()
)
heatmap_ggplot
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation)) +
geom_tile(color='white', linewidth = 0.5) +
scale_fill_gradient2(
low = 'red',
mid = 'white',
high = 'darkgreen',
midpoint = 0,
limit=c(-1,1),
name = 'Pearson\nCorrelation'
) +
labs(
title = "Correlation Heatmap (ggplot2)",
x=NULL,
y=NULL
) +
theme_minimal() +
theme(
axis.title.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 10),
panel.grid.major = element_blank(),
panel.border=element_blank(),
title = element_text(hjust = 0.5)
)
heatmap_ggplot
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation)) +
geom_tile(color='white', linewidth = 0.5) +
scale_fill_gradient2(
low = 'red',
mid = 'white',
high = 'darkgreen',
midpoint = 0,
limit=c(-1,1),
name = 'Pearson\nCorrelation'
) +
labs(
title = "Correlation Heatmap (ggplot2)",
x=NULL,
y=NULL
) +
theme_minimal() +
theme(
axis.title.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 10),
panel.grid.major = element_blank(),
panel.border=element_blank(),
plot.title = element_text(hjust = 0.5)
)
heatmap_ggplot
heatmap_ggplot<- ggplot(cor_long, aes(x=Var1, y=Var2, fill = Correlation)) +
geom_tile(color='white', linewidth = 0.5) +
scale_fill_gradient2(
low = 'red',
mid = 'white',
high = 'darkgreen',
midpoint = 0,
limit=c(-1,1),
name = 'Pearson\nCorrelation'
) +
labs(
title = "Correlation Heatmap (ggplot2)",
x=NULL,
y=NULL
) +
theme_minimal() +
theme(
axis.title.x = element_text(angle = 45, vjust = 1, hjust = 1, size = 10),
panel.grid.major = element_blank(),
panel.border=element_blank(),
plot.title = element_text(hjust = 0.5)
)
clear
save.image("E:/Data Anaysis/Red_wine_analysis/Workspace.RData")
